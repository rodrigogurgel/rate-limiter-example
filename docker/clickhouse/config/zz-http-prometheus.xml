<?xml version="1.0"?>
<clickhouse>
    <http_port>8123</http_port>
    <listen_host>0.0.0.0</listen_host>
    <listen_host>::</listen_host>

    <profiles>
        <default>
            <allow_experimental_time_series_table>1</allow_experimental_time_series_table>
            <max_memory_usage>6000000000</max_memory_usage>
            <max_bytes_before_external_group_by>4000000000</max_bytes_before_external_group_by>
            <max_bytes_before_external_sort>4000000000</max_bytes_before_external_sort>
        </default>
    </profiles>

    <prometheus>
        <port>9363</port>
        <handlers>
            <metrics>
                <url>/metrics</url>
                <handler>
                    <type>expose_metrics</type>
                    <metrics>true</metrics>
                    <asynchronous_metrics>true</asynchronous_metrics>
                    <events>true</events>
                    <errors>true</errors>
                </handler>
            </metrics>

            <rw>
                <url>/write</url>
                <handler>
                    <type>remote_write</type>
                    <database>metrics</database>
                    <table>prom_rw</table>
                </handler>
            </rw>

            <rr>
                <url>/read</url>
                <handler>
                    <type>remote_read</type>
                    <database>metrics</database>
                    <table>prom_rw</table>
                </handler>
            </rr>
        </handlers>
    </prometheus>
</clickhouse>
